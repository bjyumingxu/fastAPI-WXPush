# å¾®ä¿¡æ¶ˆæ¯æ¨é€æœåŠ¡ - æŠ€æœ¯æ ˆåˆ†æ

## ä¸€ã€æŠ€æœ¯æ ˆæ¨èæ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šPython + FastAPIï¼ˆæ¨è â­â­â­â­â­ï¼‰

#### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- **Web æ¡†æ¶**ï¼šFastAPI
- **HTTP å®¢æˆ·ç«¯**ï¼šhttpx / aiohttpï¼ˆå¼‚æ­¥ï¼‰æˆ– requestsï¼ˆåŒæ­¥ï¼‰
- **æ•°æ®éªŒè¯**ï¼šPydanticï¼ˆFastAPI å†…ç½®ï¼‰
- **æ¨¡æ¿å¼•æ“**ï¼šJinja2ï¼ˆç”¨äºæ¶ˆæ¯è¯¦æƒ…é¡µé¢ï¼‰
- **éƒ¨ç½²**ï¼šuvicorn / gunicorn
- **å®¹å™¨åŒ–**ï¼šDocker + Python å®˜æ–¹é•œåƒ

#### ä¼˜åŠ¿
- âœ… **æ€§èƒ½ä¼˜ç§€**ï¼šFastAPI åŸºäº Starletteï¼Œæ€§èƒ½æ¥è¿‘ Go/Node.js
- âœ… **å¼€å‘æ•ˆç‡é«˜**ï¼šè‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ï¼ˆSwagger/OpenAPIï¼‰
- âœ… **ç±»å‹å®‰å…¨**ï¼šåŸºäº Python ç±»å‹æç¤ºï¼ŒPydantic è‡ªåŠ¨éªŒè¯
- âœ… **å¼‚æ­¥æ”¯æŒ**ï¼šåŸç”Ÿæ”¯æŒ async/awaitï¼Œé€‚åˆå¹¶å‘å¤„ç† HTTP è¯·æ±‚
- âœ… **ç”Ÿæ€ä¸°å¯Œ**ï¼šå¾®ä¿¡ API è°ƒç”¨åº“æˆç†Ÿï¼ˆwechatpyã€wechat-api ç­‰ï¼‰
- âœ… **ç®€æ´æ˜“ç”¨**ï¼šä»£ç é‡å°‘ï¼Œå­¦ä¹ æˆæœ¬ä½

#### ä¾èµ–åº“æ¨è
```python
fastapi==0.104.1
uvicorn[standard]==0.24.0
httpx==0.25.0  # å¼‚æ­¥ HTTP å®¢æˆ·ç«¯
jinja2==3.1.2  # æ¨¡æ¿å¼•æ“
python-multipart==0.0.6  # è¡¨å•å¤„ç†
```

#### ç¤ºä¾‹ä»£ç ç»“æ„
```
project/
â”œâ”€â”€ main.py              # FastAPI åº”ç”¨å…¥å£
â”œâ”€â”€ routers/
â”‚   â””â”€â”€ send.py         # /send æ¥å£è·¯ç”±
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ wechat.py       # å¾®ä¿¡å…¬ä¼—å¹³å°æœåŠ¡
â”‚   â””â”€â”€ workwechat.py   # ä¼ä¸šå¾®ä¿¡æœåŠ¡
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ detail.html     # æ¶ˆæ¯è¯¦æƒ…é¡µæ¨¡æ¿
â”œâ”€â”€ requirements.txt
â””â”€â”€ Dockerfile
```

---

### æ–¹æ¡ˆäºŒï¼šNode.js + Express/Fastifyï¼ˆæ¨è â­â­â­â­ï¼‰

#### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- **Web æ¡†æ¶**ï¼šExpress.js æˆ– Fastify
- **HTTP å®¢æˆ·ç«¯**ï¼šaxios / node-fetch
- **æ¨¡æ¿å¼•æ“**ï¼šejs / handlebarsï¼ˆç”¨äºæ¶ˆæ¯è¯¦æƒ…é¡µé¢ï¼‰
- **éƒ¨ç½²**ï¼šNode.js åŸç”Ÿ / PM2
- **å®¹å™¨åŒ–**ï¼šDocker + Node å®˜æ–¹é•œåƒ

#### ä¼˜åŠ¿
- âœ… **å¼‚æ­¥ I/O**ï¼šNode.js å¤©ç”Ÿå¼‚æ­¥ï¼Œé€‚åˆ I/O å¯†é›†å‹ä»»åŠ¡
- âœ… **ç”Ÿæ€ä¸°å¯Œ**ï¼šnpm åŒ…ç®¡ç†ï¼Œå¾®ä¿¡ç›¸å…³åº“å®Œå–„
- âœ… **JSON å¤„ç†**ï¼šåŸç”Ÿæ”¯æŒï¼Œæ— éœ€é¢å¤–åº“
- âœ… **æ€§èƒ½ä¼˜ç§€**ï¼šFastify æ€§èƒ½æ¥è¿‘ Go
- âœ… **å¼€å‘é€Ÿåº¦å¿«**ï¼šJavaScript/TypeScript çµæ´»é«˜æ•ˆ

#### ä¾èµ–åº“æ¨è
```json
{
  "express": "^4.18.2",
  "axios": "^1.6.0",
  "ejs": "^3.1.9",
  "dotenv": "^16.3.1"
}
```

#### ç¤ºä¾‹ä»£ç ç»“æ„
```
project/
â”œâ”€â”€ index.js            # Express åº”ç”¨å…¥å£
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ send.js        # /send è·¯ç”±
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ wechat.js      # å¾®ä¿¡å…¬ä¼—å¹³å°æœåŠ¡
â”‚   â””â”€â”€ workwechat.js  # ä¼ä¸šå¾®ä¿¡æœåŠ¡
â”œâ”€â”€ views/
â”‚   â””â”€â”€ detail.ejs     # æ¶ˆæ¯è¯¦æƒ…é¡µæ¨¡æ¿
â”œâ”€â”€ package.json
â””â”€â”€ Dockerfile
```

---

### æ–¹æ¡ˆä¸‰ï¼šPython + Flaskï¼ˆè½»é‡çº§ â­â­â­ï¼‰

#### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- **Web æ¡†æ¶**ï¼šFlask
- **HTTP å®¢æˆ·ç«¯**ï¼šrequests
- **æ¨¡æ¿å¼•æ“**ï¼šJinja2ï¼ˆFlask å†…ç½®ï¼‰
- **éƒ¨ç½²**ï¼šgunicorn / uwsgi
- **å®¹å™¨åŒ–**ï¼šDocker

#### ä¼˜åŠ¿
- âœ… **è½»é‡çº§**ï¼šæ¡†æ¶å°å·§ï¼Œé€‚åˆç®€å•é¡¹ç›®
- âœ… **å­¦ä¹ æˆæœ¬ä½**ï¼šAPI ç®€æ´ï¼Œä¸Šæ‰‹å¿«
- âœ… **çµæ´»**ï¼šå¯é€‰æ‹©æ€§æ·»åŠ ä¸­é—´ä»¶
- âš ï¸ **æ€§èƒ½ä¸€èˆ¬**ï¼šç›¸æ¯” FastAPI æ€§èƒ½ç•¥ä½

---

### æ–¹æ¡ˆå››ï¼šJava + Spring Bootï¼ˆä¼ä¸šçº§ â­â­â­ï¼‰

#### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- **Web æ¡†æ¶**ï¼šSpring Boot
- **HTTP å®¢æˆ·ç«¯**ï¼šRestTemplate / WebClient
- **æ¨¡æ¿å¼•æ“**ï¼šThymeleaf
- **éƒ¨ç½²**ï¼šå†…åµŒ Tomcat
- **å®¹å™¨åŒ–**ï¼šDocker + OpenJDK é•œåƒ

#### ä¼˜åŠ¿
- âœ… **ä¼ä¸šçº§**ï¼šé€‚åˆå¤§å‹é¡¹ç›®ï¼Œç”Ÿæ€å®Œå–„
- âœ… **ç±»å‹å®‰å…¨**ï¼šJava å¼ºç±»å‹ç³»ç»Ÿ
- âš ï¸ **èµ„æºå ç”¨å¤§**ï¼šå†…å­˜å’Œå¯åŠ¨æ—¶é—´è¾ƒé•¿
- âš ï¸ **ä»£ç é‡å¤§**ï¼šç›¸æ¯” Python/Node.js ä»£ç æ›´å†—é•¿

---

## äºŒã€æŠ€æœ¯æ ˆå¯¹æ¯”

| ç»´åº¦ | Python + FastAPI | Node.js + Express | Python + Flask | Java + Spring Boot |
|------|------------------|-------------------|----------------|-------------------|
| **æ€§èƒ½** | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­ | â­â­â­â­ |
| **å¼€å‘æ•ˆç‡** | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­ |
| **å­¦ä¹ æˆæœ¬** | â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­ |
| **ç”Ÿæ€ä¸°å¯Œåº¦** | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ |
| **å†…å­˜å ç”¨** | ä¸­ç­‰ | è¾ƒä½ | è¾ƒä½ | è¾ƒé«˜ |
| **Docker é•œåƒå¤§å°** | ~150MB | ~150MB | ~150MB | ~200MB+ |
| **å¹¶å‘å¤„ç†** | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­ | â­â­â­â­ |

---

## ä¸‰ã€æ¨èæ–¹æ¡ˆè¯¦ç»†è¯´æ˜

### ğŸ† é¦–é€‰ï¼šPython + FastAPI

#### æ ¸å¿ƒä»£ç ç¤ºä¾‹ç»“æ„

**main.py**
```python
from fastapi import FastAPI
from fastapi.responses import HTMLResponse
from routers import send

app = FastAPI(title="å¾®ä¿¡æ¶ˆæ¯æ¨é€æœåŠ¡")
app.include_router(send.router)

@app.get("/health")
async def health():
    return {"status": "ok"}

@app.get("/detail", response_class=HTMLResponse)
async def detail():
    # è¿”å›æ¶ˆæ¯è¯¦æƒ…é¡µ
    pass
```

**routers/send.py**
```python
from fastapi import APIRouter, Query, Body
from pydantic import BaseModel
from services.wechat import WeChatService
from services.workwechat import WorkWeChatService

router = APIRouter()

class SendRequest(BaseModel):
    title: str
    content: str
    appid: str
    secret: str
    userid: str
    base_url: str = None
    channel: str = "wechat"

@router.get("/send")
@router.post("/send")
async def send_message(
    request: SendRequest = Body(...)  # POST
    # æˆ–ä½¿ç”¨ Query å‚æ•°å¤„ç† GET
):
    if request.channel == "workwechat":
        service = WorkWeChatService()
    else:
        service = WeChatService()
    
    result = await service.send_message(
        appid=request.appid,
        secret=request.secret,
        userid=request.userid,
        title=request.title,
        content=request.content,
        base_url=request.base_url
    )
    return result
```

**services/wechat.py**
```python
import httpx

class WeChatService:
    async def get_access_token(self, appid: str, secret: str):
        async with httpx.AsyncClient() as client:
            response = await client.get(
                "https://api.weixin.qq.com/cgi-bin/token",
                params={"grant_type": "client_credential", "appid": appid, "secret": secret}
            )
            return response.json()
    
    async def send_template_message(self, access_token, userid, title, content, base_url):
        # è°ƒç”¨å¾®ä¿¡æ¨¡æ¿æ¶ˆæ¯æ¥å£
        pass
```

#### ä¾èµ–æ–‡ä»¶ requirements.txt
```txt
fastapi==0.104.1
uvicorn[standard]==0.24.0
httpx==0.25.0
jinja2==3.1.2
python-multipart==0.0.6
```

#### Dockerfile ç¤ºä¾‹
```dockerfile
FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 5566

CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "5566"]
```

---

## å››ã€å…³é”®æŠ€æœ¯ç‚¹

### 1. HTTP å®¢æˆ·ç«¯é€‰æ‹©
- **Python**ï¼šæ¨è `httpx`ï¼ˆå¼‚æ­¥ï¼‰æˆ– `requests`ï¼ˆåŒæ­¥ï¼‰
- **Node.js**ï¼šæ¨è `axios` æˆ–åŸç”Ÿ `fetch`ï¼ˆNode 18+ï¼‰

### 2. å¾®ä¿¡ API è°ƒç”¨
- **å¾®ä¿¡å…¬ä¼—å¹³å°**ï¼š`https://api.weixin.qq.com/cgi-bin/token`ï¼ˆè·å– tokenï¼‰
- **ä¼ä¸šå¾®ä¿¡**ï¼š`https://qyapi.weixin.qq.com/cgi-bin/gettoken`ï¼ˆè·å– tokenï¼‰

### 3. æ¶ˆæ¯è¯¦æƒ…é¡µ
- ä½¿ç”¨æ¨¡æ¿å¼•æ“æ¸²æŸ“ HTMLï¼ˆJinja2/ejs/Thymeleafï¼‰
- æ”¯æŒåŠ¨æ€æ˜¾ç¤ºæ¶ˆæ¯å†…å®¹

### 4. é”™è¯¯å¤„ç†
- ç»Ÿä¸€é”™è¯¯å“åº”æ ¼å¼
- è®°å½•é”™è¯¯æ—¥å¿—ï¼ˆä¸è®°å½•æ•æ„Ÿä¿¡æ¯ï¼‰

### 5. å¹¶å‘å¤„ç†
- Pythonï¼šä½¿ç”¨ `async/await` æˆ–çº¿ç¨‹æ± 
- Node.jsï¼šåŸºäºäº‹ä»¶å¾ªç¯ï¼Œå¤©ç„¶å¹¶å‘

---

## äº”ã€æœ€ç»ˆæ¨è

### ğŸ¯ æ¨èæŠ€æœ¯æ ˆï¼š**Python + FastAPI**

**ç†ç”±**ï¼š
1. âœ… æ€§èƒ½ä¼˜ç§€ï¼Œå¼‚æ­¥æ”¯æŒå®Œå–„
2. âœ… å¼€å‘æ•ˆç‡é«˜ï¼Œä»£ç ç®€æ´
3. âœ… è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£
4. âœ… ç±»å‹å®‰å…¨ï¼Œå‡å°‘é”™è¯¯
5. âœ… å¾®ä¿¡ç›¸å…³åº“æˆç†Ÿ
6. âœ… Docker éƒ¨ç½²ç®€å•

**é€‚åˆåœºæ™¯**ï¼š
- ä¸­å°å‹é¡¹ç›®
- å¿«é€Ÿå¼€å‘è¿­ä»£
- éœ€è¦é«˜æ€§èƒ½ API æœåŠ¡
- å›¢é˜Ÿç†Ÿæ‚‰ Python

---

## å…­ã€å¤‡é€‰æ–¹æ¡ˆ

å¦‚æœå›¢é˜Ÿæ›´ç†Ÿæ‚‰ JavaScript/TypeScriptï¼Œ**Node.js + Express/Fastify** ä¹Ÿæ˜¯ä¼˜ç§€é€‰æ‹©ï¼Œæ€§èƒ½å’Œå¼€å‘æ•ˆç‡ä¸ FastAPI ç›¸å½“ã€‚



